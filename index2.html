<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<HTML xmlns="http://www.w3.org/1999/xhtml">
 
<HEAD>
    <TITLE>Login</TITLE>
 
    <script LANGUAGE="JavaScript" src="/JS/captcha.js"></SCRIPT>
 
    <script LANGUAGE="JavaScript">
        var Logged = 0;
        var isIPv4 = "1";
        var ServerLanIP;
        if ('0' == isIPv4)
            ServerLanIP = "http://[" + "fe80::1" + "]";
        else ServerLanIP = "http://" + "192.168.20.1";
 
        function getCookie(Name) {
            var search = Name + "=";
            if (document.cookie.length > 0) {
                offset = document.cookie.indexOf(search);
                if (offset != -1) {
                    offset += search.length;
                    end = document.cookie.indexOf(";", offset);
                    if (end == -1) end = document.cookie.length;
                    return unescape(document.cookie.substring(offset, end));
                } else
                    return "";
            } else
                return "";
        }
 
        function rmCookie(name) {
            var exp = new Date();
            exp.setTime(exp.getTime() - 10000);
            document.cookie = name + "=del;expires=" + exp.toGMTString();
            document.cookie = name + "=del;expires=" + exp.toGMTString() + ";path=/;";
        }
 
        function gotoSimCardMsg() {
            rmCookie("UID");
            rmCookie("PSW");
            rmCookie("LoginTimes");
            top.window.location.href = '/cgi-bin/InsertSimcardMsg.cgi';
        }
 
        var Logged = 0;
        var pswST = 0;
        var gotoMainSet = 0;
        var upgrade_flag = 0;
        var modify_flag = 0;
 
        function userlogin(login) {
            Logged = login;
        }
 
        function userPSWST(st) {
            pswST = st;
        }
 
        function gotomain_set() {
            gotoMainSet = 1;
        }
 
        function gotomodify_set() {
            modify_flag = 1;
        }
 
        function gotomain() {
            if (1 != gotoMainSet)
                return -1;
 
            if (2 == pswST)
                return -2;
            else if (1 == pswST) {
                if (0 == Logged) {
                    rmCookie("LoginTimes");
                    top.window.location.href = '/cgi-bin/content.asp';
                    return 1;
                } else {
                    rmCookie("UID");
                    rmCookie("PSW");
                    rmCookie("LoginTimes");
                    if (upgrade_flag == 0) {
                        if (1 == Logged)
                            document.write('Super user has already logged in!');
                        else if (2 == Logged)
                            document.write('User has already logged in!');
                    } else {
 
                        document.write('<label><font size=5 color=red>The device is upgrading. Please wait a moment......</font><label>');
 
                    }
                }
            }
            return 0;
        }
 
        function gotoModifyWeb() {
            if (1 != modify_flag)
                return -1;
 
            rmCookie("LoginTimes");
            top.window.location.href = '/cgi-bin/account_mod.asp';
 
            return 1;
        }
 
        function Upgrade_Read() {
 
            upgrade_flag = 1;
 
        }
 
        function refreshself() {
            top.window.location.href = '/cgi-bin/index2.asp';
        }
    </script>
    <META http-equiv=Content-Type content="text/html; charset=UTF-8">
    <SCRIPT language=JavaScript src="/JS/util.js"></SCRIPT>
 
    <STYLE type=text/css>
        #div_visite {
            FONT-SIZE: 12px;
            MARGIN: 100px 50px;
            COLOR: #333333;
            FONT-FAMILY: "Arial"
        }
 
        TABLE {
            FONT-SIZE: 15px;
            FONT-FAMILY: "Arial"
        }
 
        .code {
            /*margin-left: -20%;*/
            /*background:url(code_bg.jpg);*/
            font-family: Arial;
            font-style: italic;
            color: blue;
            font-size: 30px;
            border: 0;
            padding: 2px 3px;
            letter-spacing: 3px;
            font-weight: bolder;
            /*float:left;*/
            cursor: pointer;
            /*width:150px;*/
            height: 60px;
            /*line-height:60px;*/
            text-align: center;
            vertical-align: middle;
        }
    </STYLE>
 
    <SCRIPT language=JavaScript type=text/javascript>
        var rstatus = "99";
        var rresult = "99";
 
        function getsec(str) {
            var str1 = str.substring(1, str.length) * 1;
            var str2 = str.substring(0, 1);
            if (str2 == "s") {
                return str1 * 1000;
            } else if (str2 == "h") {
                return str1 * 60 * 60 * 1000;
            } else if (str2 == "d") {
                return str1 * 24 * 60 * 60 * 1000;
            }
        }
 
        function setCookie(name, value, time) {
            var strsec = getsec(time);
            var exp = new Date();
            exp.setTime(exp.getTime() + strsec * 1);
            document.cookie = name + "=" + escape(value) + ";expires=" + exp.toGMTString();
        }
 
        var LoginTimes = 0;
        if ((getCookie("LoginTimes") != "") && (typeof(getCookie("LoginTimes")) != "undefined")) {
            LoginTimes = parseInt(getCookie("LoginTimes"));
        }
 
 
        /* create session ID */
        function PrefixInteger(num, length) {
            return (Array(length).join('0') + num).slice(-length);
        }
 
        function createNewSessionID() {
            var t_time = new Date();
            var seed = t_time.getTime();
            var t_rand = Math.random(seed);
            var t_rand_i = parseInt(t_rand * seed);
            var t_rand_i_str = t_rand_i.toString(16);
 
            if (t_rand_i_str.length > 8)
                t_rand_i_str = t_rand_i_str.substr(0, 8);
            else if (t_rand_i_str.length < 8) {
                t_rand_i_str = PrefixInteger(0, 8 - t_rand_i_str.length) + t_rand_i_str;
            }
 
            /* ex. boasid3e0e965b */
            t_rand_i_str = 'boasid' + t_rand_i_str;
 
            var cookie = 'SESSIONID=' + t_rand_i_str + ';path=/;';
            document.cookie = cookie;
        }
 
        function getIPv4FromURL(url) {
            var ip = /\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/;
            /\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/;
            var ipaddr = ip.exec(url);
            return ipaddr;
        }
 
        function SubmitForm() {
            var Username = document.getElementById('Username');
            var Password = document.getElementById('Password');
            var Password1 = document.getElementById('Password1');
            var Password2 = document.getElementById('Password2');
            var hLoginTimes = document.getElementById('hLoginTimes');
            var sessionID = getCookie('SESSIONID');
 
            if (Username.value == "") {
                alert("Username can not be empty!");
                return false;
            }
            if (Password.value == "") {
                alert("Password can not be blank!");
                return false;
            }
 
            if (validateCode() < 0) {
                return false;
            }
 
            if (sessionID.indexOf('boasid') < 0) {
                createNewSessionID();
            }
            Password1.value = Password.value;
            Password2.value = Password.value;
            var cookie = "UID=" + Username.value + ";path=/;";
            document.cookie = cookie;
            var cookie = "PSW=" + Password.value + ";path=/;";
            document.cookie = cookie;
            LoginTimes = parseInt(LoginTimes) + 1;
            setCookie("LoginTimes", LoginTimes, "s60");
            hLoginTimes.value = LoginTimes;
            document.ConfigForm.submit();
            return true;
        }
 
        function btnbandReg() {
 
 
 
            document.cookie = "RegPageStatus=0";
            document.cookie = "RegPagetimeoutcount=0";
            if ('0' == isIPv4) {
 
                location.replace(ServerLanIP + '/cgi-bin/register.asp');
 
            } else {
                var url = "http://" + getIPv4FromURL(top.window.location.href) + '/cgi-bin/register.asp';
                location.replace(url);
 
            }
 
 
 
            return true;
        }
 
        function btnRouteSetting() {
            location.replace(ServerLanIP + "/cgi-bin/routesetting.asp");
            return true;
        }
 
 
 
 
        function onHandleKeyDown(e) {
            var key = 0;
            if (window.event) {
                key = window.event.keyCode;
            } else if (e) {
                key = e.which;
            }
            if (key == 13 && document.activeElement.id != 'btnSubmit' && document.activeElement.id != 'bandReg') {
                SubmitForm();
            }
        }
        if (!(0 != Logged && pswST))
            document.onkeypress = onHandleKeyDown;
 
        function LoadFrame() {
 
            if (1 == gotoModifyWeb())
                return;
 
 
            if (1 == gotomain())
                return;
 
 
            document.getElementById('bandReg').style.display = "none";
 
 
 
 
 
 
 
 
            createCode();
 
        }
    </SCRIPT>
 
    <META content="Microsoft FrontPage 5.0" name="GENERATOR">
</HEAD>
 
<BODY onload="LoadFrame()">
    <SCRIPT language=JavaScript type=text/javascript>
        if (LoginTimes >= 3 && !(1 == gotoMainSet && 1 == pswST && 0 == Logged)) {
            document.write('Three times of continuous login failure, WEB login is locked, Pls kindly wait 1 minute before retry!');
        }
    </SCRIPT>
 
 
 
    <DIV id=div_visite>
        <FORM id="ConfigForm" name="ConfigForm" action="/cgi-bin/index2.asp" method="post">
            <TABLE style="POSITION: relative" borderColor="#e7e7e7" height="45%" cellSpacing="0" cellPadding="0" align="center" bgColor="#e7e7e7" border="0">
                <TBODY>
                    <TR>
                        <TD align="middle" bgColor="#ffffff" colSpan="3" height="10"><LABEL>
 
                                <IMG height="137" src="/img/logo.jpg" width="337">
 
                            </LABEL></TD>
                    </TR>
 
                    <TR>
                        <TD align=right width="30%" height=50>
                            <script language="JavaScript" type="text/JavaScript">
 
                                document.writeln("Username:");
 
	</script>
                        </TD>
                        <TD width=30>　</TD>
                        <TD><LABEL>
                                <INPUT id="Username" style="WIDTH: 140px; FONT-FAMILY: Arial" name="Username" size="20"> </LABEL></TD>
                    </TR>
 
                    <TR>
                        <TD align=right height=30>
 
                             Password:
 
                        </TD>
                        <TD>　</TD>
                        <TD>
                            <input id="Logoff" type="hidden" name="Logoff" value="0">
                            <input id="hLoginTimes" type="hidden" name="hLoginTimes" value="0">
                            <input id="hLoginTimes_Zero" type="hidden" name="hLoginTimes_Zero" value="0">
                            <input id="value_one" type="hidden" name="value_one" value="1">
                            <input id="Password1" type="hidden" name="Password1" value="">
                            <input id="Password2" type="hidden" name="Password2" value="">
                            <input id="logintype" type="hidden" name="logintype" value="usr">
                            <INPUT id="Password" style="WIDTH: 140px; FONT-FAMILY: Arial" type="password" name="Password" size="20">
                        </TD>
                    </TR>
                    <TR>
                        <TD style="COLOR: #ff0000" align="center" colspan="3">
                            <SCRIPT language=javascript>
                                if (LoginTimes > 0 && LoginTimes < 3 && !(1 == gotoMainSet && 1 == pswST && 0 == Logged) && 1 != modify_flag) {
                                    var str = 'You has already tried' + LoginTimes + ' times that user name or password wrong!';
                                    document.write(str);
 
                                }
                            </SCRIPT>
                        </TD>
                    </TR>
 
                    <TR>
                        <td colSpan=3 align=center><LABEL id="checkCode" class="code" onclick="createCode()"></LABEL>  <INPUT id="refreshCode" onclick="createCode()" type="button" value="refresh" name="refreshCode"></td>
                    </TR>
                    <TR>
                        <td align=right height=30> validate code</td>
                        <td></td>
                        <td><LABEL><input type="text" style="WIDTH: 140px; FONT-FAMILY: Arial" id="inputCode" /></LABEL></td>
                    </TR>
 
 
                    <TR style="height:40px">
                        <TD align=center colSpan=3>
 
                            <INPUT id="btnSubmit" onclick="SubmitForm()" type="button" value="Login" name="btnSubmit"> 
                            <input type="reset" value="Reset" class="login-button">
 
 
                            <INPUT id="bandReg" onclick="btnbandReg()" type="button" value="Device Register" name="bandReg"> 
 
 
                        </TD>
                    </TR>
                </TBODY>
            </TABLE>
        </FORM>
    </DIV>
    <SCRIPT language=JavaScript type=text/javascript>
        if ((LoginTimes >= 3) || (Logged && pswST) || (1 == gotoMainSet && 1 == pswST && 0 == Logged)) {
            getElById('div_visite').style.display = 'none';
        } else {
 
            getElById('Username').focus();
 
        }
 
        getElById('Username').value = "admin";
    </SCRIPT>
</BODY>
 
</html>
